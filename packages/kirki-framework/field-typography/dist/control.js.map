{"mappings":"YAEwE,SAC/DA,EAA+CC,EAAIC,GAC3D,IAAIC,EAASC,EAAUC,EAAaC,EAAYC,EAAmBC,EAAkBC,OAInF,KAFFN,EAAUO,GAAGC,UAAUR,QAASF,MAOhCG,GADAF,EAAoBA,GAASC,EAAQS,QAAQC,OACpB,gBAAmBC,iBAAiBC,MAAOb,EAAK,gBACzEG,EAAW,CAAW,IAAK,KAC3BC,GAAsBF,EACtBG,EAAoBG,GAAGC,UAAUR,QAASF,EAAE,iBAC5CO,EAAoBE,GAAGC,UAAUR,QAASF,EAAE,gBAEvCG,IAKJC,EAAW,GACXW,EAAEC,KAAMH,iBAAiBC,MAAOb,EAAK,gBAAkBgB,UAAQ,SAAYC,IACrE,IAAOA,EAAQC,QAAO,OAC1Bd,GAAa,GAEda,EAAO,YAAiBA,GAAO,WAAiBA,EAAU,IAAME,SAAUF,EAAS,KAC9E,IAAOd,EAAYe,QAASD,IAChCd,EAAYiB,KAAMD,SAAUF,EAAS,MAG/Bb,GAAcE,GACpBA,EAAiBI,QAAQW,IAAG,cAazB,IAAOlB,EAAYe,QAASC,SAAUnB,EAAK,eAAiB,OAGhEO,EAAUJ,EAAYmB,QAAM,SAAYC,EAAMC,UACpCC,KAAKC,IAAKF,EAAOL,SAAUnB,EAAK,eAAiB,KAASyB,KAAKC,IAAKH,EAAOJ,SAAUnB,EAAK,eAAiB,KAASwB,EAAOD,KAErIlB,EAAkBsB,eAAc,eAAkBpB,EAAQqB,YAC1DvB,EAAkBK,QAAQW,IAAKd,EAAQqB,aAMnC,EAAIzB,EAAY0B,QAAU5B,EAAQ6B,SACtCzB,EAAkB0B,WAElB1B,EAAkB2B,aAMd3B,IACJA,EAAkB4B,OAAOC,QAAO,GAChCpB,EAAEC,KAAI,CAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,eAAiBoB,IAC7D,IAAOhC,EAAYe,QAASiB,KAChC9B,EAAkB4B,OAAOC,QAASC,EAAOP,YAAeQ,iBAAkBD,EAAOP,YACjFvB,EAAkBgC,iBAAgB,GAClChC,EAAkBiC,sBAMtB9B,GAAG+B,MAAMC,UAAS,wCACsB,SAChC,SACGC,GACJpC,GAAqBN,EAAE,kBAAuB0C,EAAY1C,IAC9De,EAAEC,KAAI,CAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,eAAiBoB,IAC7D,IAAOhC,EAAYe,QAASiB,KAChC9B,EAAkB4B,OAAOC,QAASC,EAAOP,YAAeQ,iBAAkBD,EAAOP,YACjFvB,EAAkBgC,iBAAgB,GAClChC,EAAkBiC,wBAQxBI,OAAQC,UAAWC,OAAK,WACvB9B,EAAEC,KAAM8B,yBAAuB,SAAY9C,GAC1CD,EAA+CC,GAE/CS,GAAGC,UAAWV,GAAE,SAAYC,GAC3BA,EAAM8C,MAAI,SAAYC,GACrBjD,EAA+CC,EAAIgD","sources":["src/control.js"],"sourcesContent":["import \"./control.scss\";\n\n/* global kirkiTypographyControls, kirkiGoogleFonts, kirkiFontWeights */\nfunction kirkiTypographyCompositeControlFontProperties( id, value ) {\n\tvar control, isGoogle, fontWeights, hasItalics, fontWeightControl, fontStyleControl, closest;\n\n\tcontrol = wp.customize.control( id );\n\n\tif ( 'undefined' === typeof control ) {\n\t\treturn;\n\t}\n\n\tvalue             = value || control.setting.get();\n\tisGoogle          = value['font-family'] && kirkiGoogleFonts.items[ value['font-family'] ];\n\tfontWeights       = [ 400, 700 ];\n\thasItalics        = ! isGoogle;\n\tfontWeightControl = wp.customize.control( id + '[font-weight]' );\n\tfontStyleControl  = wp.customize.control( id + '[font-style]' );\n\n\tif ( isGoogle ) {\n\n\t\t/**\n\t\t * Get font-weights from google-font variants.\n\t\t */\n\t\tfontWeights = [];\n\t\t_.each( kirkiGoogleFonts.items[ value['font-family'] ].variants, function( variant ) {\n\t\t\tif ( -1 !== variant.indexOf( 'i' ) ) {\n\t\t\t\thasItalics = true;\n\t\t\t}\n\t\t\tvariant = 'regular' === variant || 'italic' === variant ? 400 : parseInt( variant, 10 );\n\t\t\tif ( -1 === fontWeights.indexOf( variant ) ) {\n\t\t\t\tfontWeights.push( parseInt( variant, 10 ) );\n\t\t\t}\n\n\t\t\tif ( ! hasItalics && fontStyleControl ) {\n\t\t\t\tfontStyleControl.setting.set( 'normal' );\n\t\t\t}\n\n\t\t\t// if ( hasItalics && control.active() ) {\n\t\t\t// \tfontStyleControl.activate();\n\t\t\t// } else {\n\t\t\t// \tfontStyleControl.deactivate();\n\t\t\t// }\n\t\t} );\n\n\t\t/**\n\t\t * If the selected font-family doesn't support the selected font-weight, switch to a supported one.\n\t\t */\n\t\tif ( -1 === fontWeights.indexOf( parseInt( value['font-weight'], 10 ) ) ) {\n\n\t\t\t// Find the font-weight closest to our previous value.\n\t\t\tclosest = fontWeights.reduce( function( prev, curr ) {\n\t\t\t\treturn ( Math.abs( curr - parseInt( value['font-weight'], 10 ) ) < Math.abs( prev - parseInt( value['font-weight'], 10 ) ) ? curr : prev );\n\t\t\t} );\n\t\t\tfontWeightControl.doSelectAction( 'selectOption', closest.toString() );\n\t\t\tfontWeightControl.setting.set( closest.toString() );\n\t\t}\n\n\t\t/**\n\t\t * If there's only 1 font-weight to choose from, we can hide the control.\n\t\t */\n\t\tif ( 1 < fontWeights.length && control.active() ) {\n\t\t\tfontWeightControl.activate();\n\t\t} else {\n\t\t\tfontWeightControl.deactivate();\n\t\t}\n\n\t\t/**\n\t\t * Hide/show font-weight options depending on which are available for this font-family.\n\t\t */\n\t\tif ( fontWeightControl ) {\n\t\t\tfontWeightControl.params.choices = {};\n\t\t\t_.each( [ 100, 200, 300, 400, 500, 600, 700, 800, 900 ], function( weight ) {\n\t\t\t\tif ( -1 !== fontWeights.indexOf( weight ) ) {\n\t\t\t\t\tfontWeightControl.params.choices[ weight.toString() ] = kirkiFontWeights[ weight.toString() ];\n\t\t\t\t\tfontWeightControl.formattedOptions = [];\n\t\t\t\t\tfontWeightControl.renderContent();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\twp.hooks.addAction(\n\t\t'kirki.dynamicControl.initKirkiControl',\n\t\t'kirki',\n\t\tfunction( controlInit ) {\n\t\t\tif ( fontWeightControl && id + '[font-weight]' === controlInit.id ) {\n\t\t\t\t_.each( [ 100, 200, 300, 400, 500, 600, 700, 800, 900 ], function( weight ) {\n\t\t\t\t\tif ( -1 !== fontWeights.indexOf( weight ) ) {\n\t\t\t\t\t\tfontWeightControl.params.choices[ weight.toString() ] = kirkiFontWeights[ weight.toString() ];\n\t\t\t\t\t\tfontWeightControl.formattedOptions = [];\n\t\t\t\t\t\tfontWeightControl.renderContent();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t);\n}\n\njQuery( document ).ready( function() {\n\t_.each( kirkiTypographyControls, function( id ) {\n\t\tkirkiTypographyCompositeControlFontProperties( id );\n\n\t\twp.customize( id, function( value ) {\n\t\t\tvalue.bind( function( newval ) {\n\t\t\t\tkirkiTypographyCompositeControlFontProperties( id, newval );\n\t\t\t} );\n\t\t} );\n\t} );\n} );\n"],"names":["$6a6cd209053fe666$var$kirkiTypographyCompositeControlFontProperties","id","value","control","isGoogle","fontWeights","hasItalics","fontWeightControl","fontStyleControl","closest","wp","customize","setting","get","kirkiGoogleFonts","items","_","each","variants","variant","indexOf","parseInt","push","set","reduce","prev","curr","Math","abs","doSelectAction","toString","length","active","activate","deactivate","params","choices","weight","kirkiFontWeights","formattedOptions","renderContent","hooks","addAction","controlInit","jQuery","document","ready","kirkiTypographyControls","bind","newval"],"version":3,"file":"control.js.map"}